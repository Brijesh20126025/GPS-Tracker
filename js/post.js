var pt = ["12.936061123319718,77.62142837047577", "12.935862448914744,77.62171804904938", "12.935632404669201,77.62206673622131", "12.935438958207603,77.62239933013916", "12.935261196461985,77.62274265289307", "12.93504683654144,77.62306451797485", "12.934869074516403,77.62336492538452", "12.934670399162057,77.6237404346466", "12.934696540665088,77.62391746044159", "12.935125260923986,77.62428224086761", "12.93567423091144,77.62489914894104", "12.936076808134418,77.62539803981781", "12.936505526021145,77.62593984603882", "12.936819221568992,77.62633144855499", "12.937279307658848,77.62690544128418", "12.937859642311787,77.62768864631653", "12.938366780497507,77.62877762317657", "12.938513170709816,77.6291960477829", "12.93857590934595,77.62986660003662", "12.938539311810127,77.63062298297882", "12.93857590934595,77.63214647769928", "12.938586365783765,77.63265609741211", "12.938549768249482,77.6333212852478", "12.938612506876392,77.6341849565506", "12.938774581589533,77.63487160205841", "12.939046448613755,77.63532757759094", "12.939584953575272,77.63599276542664", "12.940196651975233,77.6364541053772", "12.9407299262791,77.63677060604095", "12.942157213657643,77.63765573501587", "12.943030312165442,77.63822436332703", "12.944332112046592,77.63900756835938", "12.944980395395497,77.63941526412964", "12.945680957764173,77.63981759548187", "12.946998427930053,77.64062225818634", "12.94804403421582,77.64081537723541", "12.948629571819593,77.64033794403076", "12.949335351924026,77.63950109481812", "12.950793957804986,77.6393187046051", "12.951667026057098,77.63978004455566", "12.952628965977883,77.64033257961273", "12.954098008362903,77.64118015766144", "12.955174952080798,77.64135718345642", "12.957219041184294,77.64136791229248", "12.958390071883695,77.64137327671051", "12.960287757260641,77.64164686203003", "12.96113988125029,77.641641497612", "12.961396040652456,77.64115333557129", "12.96073734451437,77.64158248901367", "12.960632789411521,77.64251589775085", "12.960397540269616,77.6442003250122", "12.960141379840026,77.64617443084717", "12.959864308058279,77.64849185943604", "12.959655197075419,77.65090584754944", "12.959534958180747,77.65337347984314", "12.95938858031755,77.6550418138504", "12.959242202368314,77.65763282775879", "12.959169013361414,77.65988051891327", "12.959268341294129,77.66221940517426", "12.958583500531754,77.66542196273804", "12.958201870892708,77.66795933246613", "12.957177218557455,77.67041087150574", "12.956638751609672,77.67040014266968"];

function loadDoc(pos) {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (xhttp.readyState == 4 && xhttp.status == 200) {
            document.getElementById("res").innerHTML = xhttp.responseText;
        }
    };
    xhttp.open("POST", "post/updatePos/?pos=" + pos, true);
    xhttp.send();
}
var i = 0;

function post(p) {
    if (!p) {
        loadDoc(document.getElementById("pos").value);
    } else {
        setTimeout(function() {
            loadDoc(pt[i]);
            if (i < pt.length) post(pt[i++]);
        }, 2000);
    }
}
var id, target, options;

function success(pos) {
    var crd = pos.coords;
    loadDoc([crd.latitude, crd.longitude].join(","));
    if (target.latitude === crd.latitude && target.longitude === crd.longitude) {
        console.log('Congratulations, you reached the target');
        //navigator.geolocation.clearWatch(id);
    }
}

function error(err) {
    console.warn('ERROR(' + err.code + '): ' + err.message);
}
target = {
    latitude: 0,
    longitude: 0
};
options = {
    enableHighAccuracy: true,
    timeout: 50000000,
    maximumAge: 0
};

function getLocal(event) {
    // sets your location as default
//     console.log("Brijesh");
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            var locationMarker = null;
            if (locationMarker) {
                // return if there is a locationMarker bug
                return;
            }
            lat = position.coords["latitude"];
            lng = position.coords["longitude"];

            loadDoc([lat, lng].join(","));
        }, function(error) {
            console.log("Error: ", error);
        }, {
            enableHighAccuracy: true
        });
        id = navigator.geolocation.watchPosition(success, error, options);
    }
}
